!function(e){e(document).ready(function(){const a=e(".dreamtonics"),l=a.filter(".widget"),t=a.find(".player");let r,_,p=0,n=0,s=0,i=0;const c=()=>{return widgetMedia+r.id+"_"+r.tracks[p].id+"_"+r["vocal-modes"][n]+".ogg"},o=()=>{t.jPlayer("setMedia",{mp3:c()}).jPlayer("play"),a.find(".player__trackname").text(r.tracks[p].title),e(".player__select_combo li").removeClass("selected"),e(".player__select_combo li:nth-child("+(p+1)+")").addClass("selected")},d=()=>{t.jPlayer("setMedia",{mp3:c()}).jPlayer("play",s),a.find(".player__mode_name").text(r["vocal-modes"][n])};t.jPlayer({ready:function(){l.data("track")?((_,i)=>{!a.hasClass("loading")&&a.addClass("loading"),_&&!_.hasClass("loading")&&_.addClass("loading");e.getJSON(widgetDb,function(o){if(o=o.voices,p=0,n=0,s=0,r=o.map(e=>e.id==i&&e).filter(e=>0!==Object.keys(e).length)[0]){let s=r.tracks;if(null!=s){a.find(".player__next, .player__prev, .player__mode_next, .player__mode_prev").prop("disabled",!1),$text=!1,e.each(r.text,function(e,a){$text=a.locale==widgetLocale?a:$text}),a.find(".player__ai_title").text($text.name),a.find(".player__ai_caption").text($text.copyright),a.find(".player__select_combo").html(""),e.each(s,function(l,t){let r=e("<li />",{"data-track":l,class:p==l?"selected":null}).append(e("<span />",{text:t.title,class:"player__select_track_name"}),e("<span />",{text:t.language,class:"player__select_track_tag"}));a.find(".player__select_combo").append(r)}),a.find(".player__trackname").text(s[p].title);let i=r["vocal-modes"];a.find(".player__mode_name").text(i[n]),t.jPlayer("setMedia",{mp3:c()}),1==s.length?a.find(".player__next, .player__prev").prop("disabled",!0):a.find(".player__prev").prop("disabled",!0),1==i.length?a.find(".player__mode_next, .player__mode_prev").prop("disabled",!0):a.find(".player__mode_prev").prop("disabled",!0),a.hasClass("widget")&&!l.hasClass("active")&&l.addClass("active"),_&&_.removeClass("loading"),a.removeClass("loading")}}else console.log("ID not found in database")})})(null,l.data("track")):console.log("No id is set")},timeupdate:function(e){0!=parseInt(e.jPlayer.status.currentTime)&&(s=e.jPlayer.status.currentTime)},play:function(e){i=!0},pause:function(e){i=!1},ended:function(e){i=!1},swfPath:"/",solution:"html",cssSelectorAncestor:".dreamtonics",supplied:"mp3,oga",wmode:"window",cssSelector:{play:".player__play",pause:".player__pause",stop:".player__stop",seekBar:".player__seek-bar",playBar:".player__play-bar",mute:".player__mute",unmute:".player__unmute",volumeBar:".player__volume-bar",volumeBarValue:".player__volume-bar-value",volumeMax:".player__volume-max",playbackRateBar:".player__playback-rate-bar",playbackRateBarValue:".player__playback-rate-bar-value",currentTime:".player__current-time",duration:".player__duration",title:".player__title"}}),a.on("click",".player__next:not(:disabled)",function(l){++p>0&&a.find(".player__prev").prop("disabled",!1),p+1>=r.tracks.length&&e(this).prop("disabled",!0),o(),l.preventDefault()}),a.on("click",".player__prev:not(:disabled)",function(l){--p>=0&&a.find(".player__next").prop("disabled",!1),0==p&&e(this).prop("disabled",!0),o(),l.preventDefault()}),a.on("click",".player__mode_next:not(:disabled)",function(l){++n>0&&a.find(".player__mode_prev").prop("disabled",!1),n+1>=r["vocal-modes"].length&&e(this).prop("disabled",!0),d(),l.preventDefault()}),a.on("click",".player__mode_prev:not(:disabled)",function(l){--n>=0&&a.find(".player__mode_next").prop("disabled",!1),0==n&&e(this).prop("disabled",!0),d(),l.preventDefault()}),a.on("click",".player__track:not(.player__select_active) .player__select",function(e){l.find(".player__track").addClass("player__select_active"),a.find(".player__select_combo").css({maxWidth:a.find(".player__track").width()}),e.preventDefault()}),a.on("click",".player__track.player__select_active .player__select",function(e){l.find(".player__track").removeClass("player__select_active"),_=l.find(".player__track").hasClass("player__select_active")?setTimeout(()=>{l.find(".player__track").removeClass("player__select_active")},250):null,e.preventDefault()}),a.on("click",".player__select_combo li",function(a){p=1*e(this).attr("data-track"),o(),l.find(".player__track").removeClass("player__select_active"),a.preventDefault()}),a.on("mousemove",".player__select_combo",function(e){l.find(".player__track").hasClass("player__select_active")&&clearTimeout(_),e.preventDefault()}),a.on("mouseleave",".player__select_combo",function(e){_=l.find(".player__track").hasClass("player__select_active")?setTimeout(()=>{l.find(".player__track").removeClass("player__select_active")},250):null,e.preventDefault()})})}(jQuery);